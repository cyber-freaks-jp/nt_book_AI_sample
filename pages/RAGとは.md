# RAGとは

ChatGPTに質問すれば何でも答えてくれる、そう感じている方も多いかもしれません。

しかし、実はLLMには「知らないこと」があります。そして、その弱点を補う技術が「RAG（ラグ）」です。

## LLMの弱点：知らないことは答えられない

まず、LLMがどんな情報を「知っている」のか、考えてみます。

### LLMが学習している情報

LLMは、大量のテキストデータから学習しています。たとえば、次のような情報は学習済みです。

- ウィキペディアの記事
- 書籍や論文
- プログラミングに関する文書
- 一般的な知識

つまり、**インターネット上に公開されている一般的な情報**は、LLMが学習していることが多いです。

### LLMが答えられないこと

一方で、LLMは次のような情報を「知りません」。

**1. 学習後に起きた出来事**

LLMは、学習した時点での情報しか持っていません。たとえば、2023年に学習したLLMは、2024年のニュースを知りません。

```
あなた：「昨日のサッカーの試合結果を教えて」
LLM：「申し訳ありませんが、最新の試合結果は把握していません」
```

**2. 社内の情報**

あなたの会社の業務マニュアルや、プロジェクトの仕様書は、LLMの学習データに含まれていません。

```
あなた：「うちの会社の経費精算の手順を教えて」
LLM：「一般的な経費精算の手順は説明できますが、
       貴社固有の手順はわかりません」
```

**3. 非公開のドキュメント**

あなたが今開発しているプロジェクトのREADMEや、設計書などは、LLMは読んだことがありません。

```
あなた：「このプロジェクトのデータベース設計を教えて」
LLM：「プロジェクトのファイルを読むことができないため、
       お答えできません」
```

つまり、**LLMは「学習したこと」しか知らない**のです。


## RAG：外部の情報を取ってきて渡す仕組み

RAGは、この弱点を解決する技術です。

RAGは簡単に言えば、**外部から情報を取ってきて、LLMに渡す仕組み**です。

### RAGなしの場合

従来のLLMは、自分の記憶（学習データ）だけで答えます。

```
あなた：「うちの会社の休暇制度について教えて」
LLM：「学習データに含まれていないため、わかりません」
```

### RAGありの場合

RAGを使うと、こうなります。

**事前準備（最初に一度だけ）：**
```
1. 社内の就業規則（PDFやWordファイル）をRAGシステムに登録
2. RAGシステムがファイルを読み込んで、検索できる状態にする
```

**実際に質問するとき：**
```
あなた：「うちの会社の休暇制度について教えて」

RAGシステム：
  1. 登録されている就業規則の中から「休暇制度」に関連する部分を検索
  2. 該当する部分（「年次有給休暇は入社6ヶ月後に10日付与...」）を見つける
  3. その情報をLLMに渡す

LLM：「御社の就業規則によると、年次有給休暇は入社6ヶ月後に
      10日付与され、その後1年ごとに...」
```

つまり、RAGは次の2つのステップで動きます。

1. **事前準備**：LLMに読ませたいドキュメント（PDF、Word、テキストファイルなど）をRAGシステムに登録する
2. **質問時**：RAGシステムが登録されたドキュメントから関連情報を検索して、LLMに渡す

**LLMが知らない情報を、外部から取ってきて教えてあげる**のがRAGです。

## RAGの具体例

RAGは、様々な場面で活用されています。

### 例1：カスタマーサポート

企業のカスタマーサポートで、RAGが活用されています。

**RAGに登録するデータ：**
- 製品マニュアル（PDF）
- 保証規定（PDF）
- よくある質問集（テキストファイル）

**質問：**
「この製品の保証期間はどれくらいですか？」

**回答：**
「この製品の保証期間は購入日から1年間です。保証期間中は無償で修理対応いたします」

### 例2：社内FAQ対応

社内のヘルプデスクでも、RAGが使われています。

**RAGに登録するデータ：**
- 就業規則（Word）
- 経費規定（PDF）
- 社内FAQ（Excelやテキスト）
- 各種申請マニュアル（PDF）

**質問：**
「テレワーク時の交通費精算はどうすればいいですか？」

**回答：**
「テレワーク時は、出社が必要な場合のみ交通費を精算できます。経費精算システムで『テレワーク出社』を選択してください」

### 例3：医療情報の提供

医療機関でも、RAGが活用され始めています。

**RAGに登録するデータ：**
- 医薬品データベース（CSV、JSON形式）
- 添付文書（PDF）
- 診療ガイドライン（PDF）
- 薬剤情報シート（テキスト）

**質問：**
「この薬の副作用について知りたいです」

**回答：**
「この薬の主な副作用は眠気、口の渇き、便秘です。これらの症状が強く出る場合は医師に相談してください」


## AI駆動開発におけるRAG

RAGは、AI駆動開発でも重要な役割を果たします。

### プロジェクト固有の情報を扱う

ソフトウェア開発では、プロジェクトごとに異なる情報があります。

- **使用している技術スタック**：React、Vue、Angularなど
- **プロジェクトの設計方針**：ディレクトリ構成、命名規則など
- **独自のライブラリや関数**：プロジェクト専用のユーティリティなど

LLMは、一般的なReactの知識は持っていますが、**あなたのプロジェクトがどんな設計になっているか**は知りません。

RAGを使えば、プロジェクトのファイルを読み込んで、LLMに教えることができます。

### 活用例1：コードベースの理解

**あなたの指示：**
「このプロジェクトのユーザー認証の仕組みを説明して」

**RAGシステム + AIエージェントの動き：**

1. プロジェクト内のファイルを検索
2. 認証に関連するファイルを特定（auth.js、login.jsなど）
3. それらのファイルを読み込む
4. LLMに情報を渡す
5. LLMがコードを解析して説明を生成

**回答：**
「このプロジェクトでは、JWT（JSON Web Token）を使った認証を実装しています。auth.jsでトークンを生成し、login.jsでユーザーのログイン処理を行っています...」

### 活用例2：ドキュメントを参照したコード生成

**あなたの指示：**
「プロジェクトのコーディング規約に従って、新しいAPIエンドポイントを追加して」

**RAGシステム + AIエージェントの動き：**

1. コーディング規約ファイルを読み込む
2. 既存のAPIエンドポイントのコードを確認
3. コーディング規約と既存コードをLLMに渡す
4. LLMが規約に従ったコードを生成
5. AIエージェントがファイルを作成

### 活用例3：エラー解決

**あなたの指示：**
「このエラーを解決して」

**RAGシステム + AIエージェントの動き：**

1. エラーメッセージを理解
2. プロジェクトの設定ファイル（package.json、tsconfig.jsonなど）を読み込む
3. エラーに関連するコードを検索
4. 情報をLLMに渡す
5. LLMが原因を特定し、修正方法を提案
6. AIエージェントがコードを修正

## RAGとAIエージェントの組み合わせ

RAGとAIエージェントを組み合わせると、さらに強力になります。

### RAGだけの場合

RAGは「情報を取ってきて答える」ことしかできません。

```
あなた：「このプロジェクトのテスト方法を教えて」
RAG：「README.mdによると、npm test を実行します」
```

### RAG + AIエージェント

RAGとAIエージェントを組み合わせると、「情報を取ってきて、実際に実行する」ことができます。

```
あなた：「このプロジェクトのテストを実行して、失敗したら修正して」

RAG + AIエージェント：
  1. README.mdからテスト方法を確認
  2. npm test を実行
  3. テストが失敗
  4. 失敗したテストコードを読み込む
  5. 関連するソースコードを読み込む
  6. 原因を特定
  7. コードを修正
  8. 再度テストを実行
  9. 成功を確認
  10. 「テストが成功しました」と報告
```


## まとめ

RAGについて学びました。

- **LLMには弱点がある**：学習していない情報は答えられない
- **RAGは外部の情報を取ってくる仕組み**：データベース、ドキュメント、コードなどを検索して、LLMに渡す
- **知らないことでも答えられる**：社内情報、プロジェクト固有の情報、最新情報などに対応できる
- **様々な場面で活用されている**：カスタマーサポート、社内FAQ、医療情報提供など
- **AI駆動開発でも重要**：プロジェクトのコードやドキュメントを参照して、より正確な支援ができる
- **AIエージェントと組み合わせる**：情報取得だけでなく、実行まで行える

RAGは、LLMの可能性を大きく広げる技術です
